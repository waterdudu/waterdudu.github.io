<!DOCTYPE HTML>

<html lang="en-us">

<head>
	<meta charset="utf-8">
	<title>waterdudu blog</title>
	<meta name="author" content="map[name:dudu email:]">

	
	
	<meta name="description" content="">
	

	
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    
	<link href='/index.xml' rel="alternate" title="waterdudu blog" type="application/atom+xml">
	
	<link rel="canonical" href="http://waterdudu.github.io/">
	<link href="http://waterdudu.github.io//favicon.png" rel="shortcut icon">
	<link href="http://waterdudu.github.io//css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="http://waterdudu.github.io//css/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	
	
</div>

<nav id="main-nav"><ul class="main">
    <li><a href="/">Blog</a></li>
    <li><a href="">About</a></li>
    <li><a href="/post/">Archives</a></li>
</ul>

</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		
		
		
		
		
		
		
		
		
		
		
    	
    	
			<a class="rss" href='/index.xml' title="RSS">RSS</a>
		
	</div>
</nav>
</header>
			</div>
		</div>
		<div class="mid-col">
			
			<div class="mid-col-container">
				<div id="content" class="inner">
					
					<div itemscope itemtype="http://schema.org/Blog">
					
				        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="meta">
		<div class="date"><time datetime='Thu, Jan 21, 2016' data-updated="true" itemprop="datePublished">Thu, Jan 21, 2016</time>
</div>
		<div class="tags">
</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="http://waterdudu.github.io/post/react/" itemprop="url">react</a></h1>
	<div class="entry-content" itemprop="articleBody">
		当更新 model 的时候，react 做了两件事： run diffing algorithm, which identifies what has changed reconciliation, update the DOM with the result of diff Webpack Gulp and Grunt handle files, while Webpack handles projects. npm init Just hit ENTER npm install --save react@0.14.3 npm install --save react-dom@0.14.3 npm install --save-dev babel-core@6.3.13 npm install --save-dev babel-loader@6.2.0 npm install --save-dev babel-preset-es2015@6.3.13 npm install --save-dev babel-preset-react@6.3.13 npm install webpack -g Next you need to create index.html file.
		<a href="http://waterdudu.github.io/post/react/" class="more-link">Read on →</a>
	</div>
</article>

				    
				        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="meta">
		<div class="date"><time datetime='Wed, Jan 20, 2016' data-updated="true" itemprop="datePublished">Wed, Jan 20, 2016</time>
</div>
		<div class="tags">
</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="http://waterdudu.github.io/post/go-concurrency-patterns/" itemprop="url">go concurrency patterns</a></h1>
	<div class="entry-content" itemprop="articleBody">
		fanIn pattern c &lt;- &lt;-input1 含义，把 input1 的信息拿出丢给 c /* A -&gt; C -&gt; B -&gt; */ func fanIn(input1, input2 &lt;-chan string) &lt;-chan string { c := make(chan string) go func() { for { c &lt;- &lt;-input1 } }() go func() { for { c &lt;- &lt;-input2 } }() return c } func main() { c := fanIn(boring(&quot;Joe&quot;), boring(&quot;Ann&quot;)) for i := 0; i &lt; 10; i++ { fmt.Println(&lt;-c) } fmt.Println(&quot;You're both boring.
		<a href="http://waterdudu.github.io/post/go-concurrency-patterns/" class="more-link">Read on →</a>
	</div>
</article>

				    
				        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="meta">
		<div class="date"><time datetime='Mon, Jan 18, 2016' data-updated="true" itemprop="datePublished">Mon, Jan 18, 2016</time>
</div>
		<div class="tags">
</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="http://waterdudu.github.io/post/go-tips/" itemprop="url">go tips</a></h1>
	<div class="entry-content" itemprop="articleBody">
		资源 github.com/golang/go/wiki go faq golang bootcamp go database-sql effective go 访问 map 的 key, value x := map[string]string{ &quot;name&quot;: &quot;dudu&quot;, &quot;love&quot;: &quot;many&quot;, } if _, ok := x[&quot;love&quot;]; !ok { fmt.Println(&quot;a person with no love&quot;) } 修改 string 时，转换成 slice x := &quot;strings are read-only&quot; xbytes := []byte(x) xbytes[0] = 'S' fmt.Println(string(xbytes)) 以下调用合法 调用 pointer receiver method，只要调用者是 pointer type，或者它能被取地址（&amp;） 调用 value recieiver method，只要调用者是 value type，或者它的 value 可以被取值（*） type List [] int func (l List) Len() int { return len(l) } func (l *List) Append(val int) { *l = append(*l, val) } // call var list List list.Append(l) fmt.Printf(&quot;%v (len: %d) \n&quot;, list, list.Len()) pList := new(List) pList.Append(2) fmt.Printf(&quot;%v (len: %d) \n&quot;, pList, pList.Len()) for range string for range 默认会把 string 当作 utf-8 字符，如果不能解析，则返回 0xfffd。 需要把它转换成 byte slice 让结果正确。 data := &quot;A\xfe\x02\xff\x04&quot; for _,v := range data { fmt.Printf(&quot;%#x &quot;,v) } //prints: 0x41 0xfffd 0x2 0xfffd 0x4 (not ok) fmt.Println() for _,v := range []byte(data) { fmt.Printf(&quot;%#x &quot;,v) } //prints: 0x41 0xfe 0x2 0xff 0x4 (good) for range map 随机 m := map[string]int{&quot;one&quot;: 1, &quot;two&quot;: 2, &quot;three&quot;: 3, &quot;four&quot;: 4} for k, v := range m { fmt.Println(k, v) } // first time run // [ `run` | done: 9.628665ms ] // one 1 // two 2 // three 3 // four 4 // second time run // [ `run` | done: 8.847101ms ] // three 3 // four 4 // one 1 // two 2 switch switch 默认是 fallthrough 的，可以在 case 语句里写成 list，或者使用 fallthrough 语句 isSpace := func(ch byte) bool { switch(ch) { case ' ', '\t': return true } return false } ++i go 不支持 prefix increment or decrement 未导出的 field 的 encode/decode 未导出的 field 不能被 encode，decode 的时候被初始化为 zero value package main import ( &quot;fmt&quot; &quot;encoding/json&quot; ) type MyData struct { One int two string } func main() { in := MyData{1,&quot;two&quot;} fmt.Printf(&quot;%#v\n&quot;,in) //prints main.MyData{One:1, two:&quot;two&quot;} encoded,_ := json.Marshal(in) fmt.Println(string(encoded)) //prints {&quot;One&quot;:1} var out MyData json.Unmarshal(encoded,&amp;out) fmt.Printf(&quot;%#v\n&quot;,out) //prints main.MyData{One:1, two:&quot;&quot;} } struct field 是 map 或者 pointer 时的修改 struct field 是 map 或者 pointer 时，可以通过 value method 修改 package main import &quot;fmt&quot; type data struct { num int key *string items map[string]bool } func (this *data) pmethod() { this.num = 7 } func (this data) vmethod() { this.num = 8 *this.key = &quot;v.key&quot; this.items[&quot;vmethod&quot;] = true } func main() { key := &quot;key.1&quot; d := data{1,&amp;key,make(map[string]bool)} fmt.Printf(&quot;num=%v key=%v items=%v\n&quot;,d.num,*d.key,d.items) //prints num=1 key=key.1 items=map[] d.pmethod() fmt.Printf(&quot;num=%v key=%v items=%v\n&quot;,d.num,*d.key,d.items) //prints num=7 key=key.1 items=map[] d.vmethod() fmt.Printf(&quot;num=%v key=%v items=%v\n&quot;,d.num,*d.key,d.items) //prints num=7 key=v.key items=map[vmethod:true] } 处理 http request 的 close 同时判断 err 和 resp redirect 失败时 resp, err 都 != nil，此时需要对 resp 做出错处理，关闭 resp.Body resp, err := http.Get(&quot;https://api.ipify.org?format=json&quot;) if resp != nil { defer resp.Body.Close() } if err != nil { fmt.Println(err) return } defer resp.Body.Close()//ok, most of the time :-) body, err := ioutil.ReadAll(resp.Body) if err != nil { fmt.Println(err) return } fmt.Println(string(body)) close http connection 标准库会根据 server 的配置来关闭 connection，这会导致我们的 app 的性能。 以下方式关闭 http 链接。 向同一个 server 发送很多请求时可以设置连接open。 向很多 server 发送请求时需要关闭连接来保证性能（或者增加 open file limit）。 设置 Close = true req.Close = true 添加 request header req.Header.Add(&quot;Connection&quot;, &quot;close&quot;) req, err := http.NewRequest(&quot;GET&quot;,&quot;http://golang.org&quot;,nil) if err != nil { fmt.Println(err) return } req.Close = true //or do this: //req.Header.Add(&quot;Connection&quot;, &quot;close&quot;) resp, err := http.DefaultClient.Do(req) if resp != nil { defer resp.Body.Close() } json number decode json 默认把数字 decode 成 float64，如需把它当作 int 使用时有以下几种方式： float64 =&gt; int var data = []byte(`{&quot;status&quot;: 200}`) var result map[string]interface{} if err := json.Unmarshal(data, &amp;result); err != nil { fmt.Println(&quot;error:&quot;, err) return } var status = uint64(result[&quot;status&quot;].(float64)) //ok use a Decoder type to unmarshal JSON, represent JSON numbers using the Number interface type var data = []byte(`{&quot;status&quot;: 200}`) var result map[string]interface{} var decoder = json.NewDecoder(bytes.NewReader(data)) decoder.UseNumber() if err := decoder.Decode(&amp;result); err != nil { fmt.Println(&quot;error:&quot;, err) return } var status,_ = result[&quot;status&quot;].(json.Number).Int64() //ok use the string representation of your Number value to unmarshal it to a different numeric type var data = []byte(`{&quot;status&quot;: 200}`) var result map[string]interface{} var decoder = json.NewDecoder(bytes.NewReader(data)) decoder.UseNumber() if err := decoder.Decode(&amp;result); err != nil { fmt.Println(&quot;error:&quot;, err) return } var status uint64 if err := json.Unmarshal([]byte(result[&quot;status&quot;].(json.Number).String()), &amp;status); err != nil { fmt.Println(&quot;error:&quot;, err) return } use a struct type that maps your numeric value to the numeric type you need.
		<a href="http://waterdudu.github.io/post/go-tips/" class="more-link">Read on →</a>
	</div>
</article>

				    
				        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="meta">
		<div class="date"><time datetime='Sat, Nov 14, 2015' data-updated="true" itemprop="datePublished">Sat, Nov 14, 2015</time>
</div>
		<div class="tags">
</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="http://waterdudu.github.io/post/photomosaic/" itemprop="url">photomosaic</a></h1>
	<div class="entry-content" itemprop="articleBody">
		Just another photo mosaic app Hallstatt Vatican Sanlitun
		
	</div>
</article>

				    
				        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="meta">
		<div class="date"><time datetime='Sat, Nov 7, 2015' data-updated="true" itemprop="datePublished">Sat, Nov 7, 2015</time>
</div>
		<div class="tags">
</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="http://waterdudu.github.io/post/swiftwordpolicy/" itemprop="url">swiftwordpolicy</a></h1>
	<div class="entry-content" itemprop="articleBody">
		Privacy Policy (effective date October 4, 2015) Privacy Policy of SwiftWord About This Policy This privacy policy describes the privacy practices of the website and apps published by SwiftWord Developer, which includes a link to this policy. Personal Information Collection: Apps published by SwiftWord Developer will not collect any personal information. Personal Information Sharing: Apps published by SwiftWord Developer may not share personal information about consumers with third parties for their own marketing purposes unless the consumer agreed to that sharing.
		<a href="http://waterdudu.github.io/post/swiftwordpolicy/" class="more-link">Read on →</a>
	</div>
</article>

				    
				        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="meta">
		<div class="date"><time datetime='Fri, Nov 6, 2015' data-updated="true" itemprop="datePublished">Fri, Nov 6, 2015</time>
</div>
		<div class="tags">
</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="http://waterdudu.github.io/post/first/" itemprop="url">first</a></h1>
	<div class="entry-content" itemprop="articleBody">
		hey first
		
	</div>
</article>

				    
				    </div>
				    <nav id="pagenavi">
					    
					    
					    <div class="center"><a href="http://waterdudu.github.io//post/">Blog Archives</a></div>
					</nav>
				</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2016

    dudu

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
<script src="http://waterdudu.github.io//js/slash.js"></script>
<script src="http://waterdudu.github.io//js/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script></footer>
		</div>
	</div>
	


	
</body>
</html>
